# ????? API ?????? ???? ?? ???? ??????? ????????

## ? ????! ??????????? ?????

**?? ???? ???? EventTypes ????!**
- ?? ??????? ?-EventTypes ???????? ???????
- ?? ?? ????? ???? `EventType` ??? **?????? ?????**
- ?? ????? ??? ???? ?????? ??????? ??????? ????? ????? ??? ?????

## Endpoint
```
POST /api/app/halls
Content-Type: multipart/form-data
```

## ???????

| ?? ???? | ??? | ???? | ????? | ????? |
|---------|-----|------|-------|-------|
| `Name` | string | ? | ?? ????? | "???? ???????" |
| `OwnerName` | string | ? | ?? ??? ????? | "??? ???" |
| `Phone` | string | ? | ????? ??? ????? | "054-1234567" |
| `Email` | string | ? | ?????? ??? ????? | "moshe@example.com" |
| `Password` | string | ? | ????? ???? ????? | "Password123!" |
| `HallAddress` | string | ? | ????? ????? | "???? ???? 10, ???????" |
| `HallPhone` | string | ? | ????? ????? | "02-1234567" |
| `HallImage` | File | ? | ????? ????? | (???? ?????) |
| `AllowedEventTypeIds` | array of strings | ? | **????** ???? ??????? | ["Wedding", "BarMitzvah"] |

## ?? ???? ??????? ???????

| ?? ??????? | ?? ?????? | ??????? ????? ???? |
|------------|-----------|-------------------|
| `Wedding` | ????? | 5 |
| `BarMitzvah` | ??/?? ????? | 4 |
| `Brit` | ???? | 3 |

**??? ???? ????? ?? ??!** ???? ???? EventType ??? ??? ??.

## ??????? ????? ?-React

### ????? 1: ????? ?? ???? ???? (?????!)

```javascript
async function createHall(hallData) {
  const formData = new FormData();
  
  // ???? ????
  formData.append('Name', hallData.name);
  formData.append('OwnerName', hallData.ownerName);
  formData.append('Phone', hallData.phone);
  formData.append('Email', hallData.email);
  formData.append('Password', hallData.password);
  
  // ???? ???????????
  if (hallData.hallAddress) formData.append('HallAddress', hallData.hallAddress);
  if (hallData.hallPhone) formData.append('HallPhone', hallData.hallPhone);
  if (hallData.hallImage) formData.append('HallImage', hallData.hallImage);
  
  // ? ???? ??????? - ???? ????!
  // ??? ??, ???? ???? EventType ??? ?????? ????? ???
  const eventTypes = ['Wedding', 'BarMitzvah', 'Brit'];
  eventTypes.forEach((name, index) => {
    formData.append(`AllowedEventTypeIds[${index}]`, name);
  });
  
  try {
    const response = await fetch('https://localhost:7168/api/app/halls', {
      method: 'POST',
      body: formData,
    });
    
    if (!response.ok) {
      throw new Error('Failed to create hall');
    }
    
    const result = await response.json();
    console.log('Hall created:', result);
    return result;
  } catch (error) {
    console.error('Error:', error);
    throw error;
  }
}

// ?????:
const newHall = {
  name: '???? ???????',
  ownerName: '??? ???',
  phone: '054-1234567',
  email: 'moshe@example.com',
  password: 'Password123!',
  hallAddress: '???? ???? 10, ???????',
  hallPhone: '02-1234567',
  hallImage: selectedFile
};

createHall(newHall);
```

### ????? 2: ????????? ????

```jsx
import React, { useState } from 'react';
import axios from 'axios';

function CreateHallForm() {
  const [formData, setFormData] = useState({
    name: '',
    ownerName: '',
    phone: '',
    email: '',
    password: '',
    hallAddress: '',
    hallPhone: '',
    hallImage: null,
    allowedEventTypes: []  // ? ???? ?? ???? ????
  });
  
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  
  // ????? ????? ?? ???? ??????? ??????
  const availableEventTypes = [
    { name: 'Wedding', label: '?????', defaultAlbums: 5 },
    { name: 'BarMitzvah', label: '??/?? ?????', defaultAlbums: 4 },
    { name: 'Brit', label: '????', defaultAlbums: 3 },
    { name: 'BirthdayParty', label: '??? ?????', defaultAlbums: 3 },
    { name: 'Engagement', label: '???????', defaultAlbums: 3 }
  ];
  
  const handleEventTypeToggle = (eventTypeName) => {
    setFormData(prev => {
      const types = prev.allowedEventTypes;
      const newTypes = types.includes(eventTypeName)
        ? types.filter(t => t !== eventTypeName)
        : [...types, eventTypeName];
      return { ...prev, allowedEventTypes: newTypes };
    });
  };
  
  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError(null);
    
    const data = new FormData();
    data.append('Name', formData.name);
    data.append('OwnerName', formData.ownerName);
    data.append('Phone', formData.phone);
    data.append('Email', formData.email);
    data.append('Password', formData.password);
    
    if (formData.hallAddress) data.append('HallAddress', formData.hallAddress);
    if (formData.hallPhone) data.append('HallPhone', formData.hallPhone);
    if (formData.hallImage) data.append('HallImage', formData.hallImage);
    
    // ? ????? ???? ??????? - ???? ????!
    formData.allowedEventTypes.forEach((typeName, index) => {
      data.append(`AllowedEventTypeIds[${index}]`, typeName);
    });
    
    try {
      const response = await axios.post('https://localhost:7168/api/app/halls', data);
      alert('????? ???? ??????!');
      console.log('Created hall:', response.data);
    } catch (err) {
      setError(err.response?.data?.message || '????? ?????? ?????');
    } finally {
      setLoading(false);
    }
  };
  
  return (
    <form onSubmit={handleSubmit}>
      <h2>????? ???? ???</h2>
      
      {error && <div className="error">{error}</div>}
      
      <input
        type="text"
        placeholder="?? ????? *"
        value={formData.name}
        onChange={(e) => setFormData({...formData, name: e.target.value})}
        required
      />
      
      <input
        type="text"
        placeholder="?? ??? ????? *"
        value={formData.ownerName}
        onChange={(e) => setFormData({...formData, ownerName: e.target.value})}
        required
      />
      
      <input
        type="tel"
        placeholder="????? *"
        value={formData.phone}
        onChange={(e) => setFormData({...formData, phone: e.target.value})}
        required
      />
      
      <input
        type="email"
        placeholder="?????? *"
        value={formData.email}
        onChange={(e) => setFormData({...formData, email: e.target.value})}
        required
      />
      
      <input
        type="password"
        placeholder="????? *"
        value={formData.password}
        onChange={(e) => setFormData({...formData, password: e.target.value})}
        required
      />
      
      <input
        type="text"
        placeholder="????? ?????"
        value={formData.hallAddress}
        onChange={(e) => setFormData({...formData, hallAddress: e.target.value})}
      />
      
      <input
        type="tel"
        placeholder="????? ?????"
        value={formData.hallPhone}
        onChange={(e) => setFormData({...formData, hallPhone: e.target.value})}
      />
      
      <input
        type="file"
        accept="image/*"
        onChange={(e) => setFormData({...formData, hallImage: e.target.files[0]})}
      />
      
      {/* ? ????? ???? ??????? */}
      <div>
        <h3>???? ??????? ?????? ?????:</h3>
        <p style={{color: '#666', fontSize: '14px'}}>
          ?? ??? ????? ???? EventType ?????? ????? ???
        </p>
        {availableEventTypes.map(et => (
          <label key={et.name} style={{display: 'block', margin: '10px 0'}}>
            <input
              type="checkbox"
              checked={formData.allowedEventTypes.includes(et.name)}
              onChange={() => handleEventTypeToggle(et.name)}
            />
            {et.label} ({et.defaultAlbums} ???????)
          </label>
        ))}
      </div>
      
      <button type="submit" disabled={loading}>
        {loading ? '???? ????...' : '??? ????'}
      </button>
    </form>
  );
}

export default CreateHallForm;
```

## ?? ?? ???? ????

???? ??????:
```javascript
AllowedEventTypeIds: ["Wedding", "BarMitzvah"]
```

???? ????:
```csharp
// EventType 1 - ?????? ????? ???
new EventType 
{ 
    EventTypeNameKey = "Wedding",
    DefaultAlbumSCount = 5,
    HallId = 1  // ???? ?????
}

// EventType 2 - ?????? ????? ???
new EventType 
{ 
    EventTypeNameKey = "BarMitzvah",
    DefaultAlbumSCount = 4,
    HallId = 1  // ???? ?????
}
```

**????**: ?? ???? ??? ???? `["Wedding"]`, ??? ???? `EventType` ??? **????**!

## ?????? ?????

### ????? (200 OK)
```json
{
  "hallId": 5,
  "message": "Hall created successfully"
}
```

### ????? (400 Bad Request)
```json
{
  "message": "Hall name is required"
}
```

## ? ??????? ????? ?????

1. **?????? ????**: ?? ???? ???? ?? ???? ???????? ???
2. **??????**: ???? ?? ???? ????? ?? ?????? ????? ??? ????
3. **?????**: ?? ???? ????? EventTypes ????????
4. **???? ??????**: ????? ???? ????? ?? ?? ?-EventTypes ???

## ?? ?????

- ??? ???? ?????? ?????? ?-API ????? EventTypes
- ??? ???? ????? ?? ?? ?????
- ???? ???? ?????? EventType ?? ?????? ????? ????
