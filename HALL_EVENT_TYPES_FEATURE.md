# ????? ???? ??????? ?????? ?????

## ????? ?????
????? ?? ?????? ?????? ???? ?? ???? ???? ???? ??????? ???? ????? ??.

## ??????? ??????

### 1. ?????? (Models)
- **Hall.cs**: ????? ????? `AllowedEventTypes` ???? `ICollection<EventType>`
- **EventType.cs**: ????? ????? `Halls` ???? `ICollection<Hall>`

### 2. DTOs
- **CreateHallDto.cs**: ????? ????? `AllowedEventTypeIds` ???? `List<int>`
- **HallDto.cs**: ????? ????? `AllowedEventTypeIds` ???? `List<int>`

### 3. DbContext
- **SmachotContext.cs**: ????? ??? Many-to-Many ??? `Hall` ?-`EventType` ?? ???? ????? `hall_event_types`

### 4. Services
- **IHallService.cs**: ????? ????? `UpdateAllowedEventTypesAsync`
- **HallService.cs**: 
  - ?????? ????? `CreateHallAsync` ???? ?????? ???? ???????
  - ??????? ????? `UpdateAllowedEventTypesAsync`

### 5. Controllers
- **HallsController.cs** (API Controller):
  - ?????? ?? ?-endpoints ?????? `AllowedEventTypeIds`
  - ????? endpoint `GetEventTypesForHall` ?????? ?? ???? ??????? ??????
  - ?????? endpoint ??? `PUT {id}/event-types` ?????? ???? ??????? ??????

- **Controllers/HallsController.cs** (MVC Controller):
  - ????? endpoint `Load` ?????? `AllowedEventTypeIds`

## Migration
?? ????? ?? ??????? ????? ??? ????? ?????? ?? ?-migration:

```bash
cd SmachotMemories
dotnet ef migrations add AddHallEventTypes
dotnet ef database update
```

## ????? ?-API

### ????? ???? ?? ???? ???????
```http
POST /api/app/halls
Content-Type: multipart/form-data

{
  "Name": "???? ???????",
  "OwnerName": "?? ??? ?????",
  "Phone": "054-1234567",
  "Email": "owner@example.com",
  "Password": "Password123!",
  "AllowedEventTypeIds": [1, 2, 3]
}
```

### ???? ???? ??????? ?????? ?????
```http
GET /api/app/halls/{hallId}/event-types
```

### ????? ???? ??????? ??????
```http
PUT /api/app/halls/{hallId}/event-types
Content-Type: application/json

[1, 2, 3]
```

## ???? ??????
???? ?????? `hall_event_types` ?????:
- `halls_hall_id` - ???? ?????
- `allowed_event_types_event_type_id` - ???? ??? ??????

??? Many-to-Many ?????:
- ????? ??? ?????? ????? ???? ???? ???????
- ??? ????? ??? ???? ????? ????? ????? ??????
